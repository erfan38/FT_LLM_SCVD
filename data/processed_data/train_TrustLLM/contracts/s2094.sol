function getPriceUSD(address asset) public view override returns (uint256) { address feed = feeds[asset]; require(feed != address(0), Error.ASSET_NOT_SUPPORTED); (, int256 answer, , uint256 updatedAt, ) = AggregatorV2V3Interface(feed).latestRoundData(); require(block.timestamp <= updatedAt + stalePriceDelay, Error.STALE_PRICE); require(answer >= 0, Error.NEGATIVE_PRICE); uint256 price = uint256(answer); uint8 decimals = AggregatorV2V3Interface(feed).decimals(); return price.scaleFrom(decimals); }
