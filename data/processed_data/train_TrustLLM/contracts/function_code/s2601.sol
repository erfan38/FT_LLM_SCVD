function _executeInflationRateUpdate() internal returns (bool) { totalAvailableToNow += (currentTotalInflation * (block.timestamp - lastEvent)); lastEvent = block.timestamp; if (block.timestamp >= lastInflationDecay + _INFLATION_DECAY_PERIOD) { currentInflationAmountLp = currentInflationAmountLp.scaledMul(annualInflationDecayLp); if (initialPeriodEnded) { currentInflationAmountKeeper = currentInflationAmountKeeper.scaledMul( annualInflationDecayKeeper ); currentInflationAmountAmm = currentInflationAmountAmm.scaledMul( annualInflationDecayAmm ); } else { currentInflationAmountKeeper = initialAnnualInflationRateKeeper / _INFLATION_DECAY_PERIOD; currentInflationAmountAmm = initialAnnualInflationRateAmm / _INFLATION_DECAY_PERIOD; initialPeriodEnded = true; } currentTotalInflation = currentInflationAmountLp + currentInflationAmountKeeper + currentInflationAmountAmm; controller.inflationManager().checkpointAllGauges(); lastInflationDecay = block.timestamp; } return true; }
