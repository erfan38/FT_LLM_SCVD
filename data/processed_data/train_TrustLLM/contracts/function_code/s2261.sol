function withdrawExcessRewards(uint poolId) external { Pool storage pool = pools[poolId]; require(pool.id == poolId, 'Uninitialized pool'); require(pool.totalDepositsWei == 0, 'Cannot withdraw until all deposits are withdrawn'); require(block.timestamp > pool.endTime, 'Contract must reach maturity'); bool success = true; for (uint i = 0; i < pool.rewardTokens.length; i++) { uint rewards = pool.rewardFunding[i]; pool.rewardFunding[i] = 0; success = success && IERC20(pool.rewardTokens[i]).transfer(pool.excessBeneficiary, rewards); } require(success, 'Token transfer failed'); emit ExcessRewardsWithdrawn(poolId); }
