function getPastVotes(address account, uint256 timestamp) public view returns (uint256 votes) { require(timestamp <= block.timestamp, "ERC20Votes: block not yet mined"); uint256 epoch = timestamp.div(rewardsDuration).mul(rewardsDuration); DelegateeCheckpoint memory ckpt = _checkpointsLookup(_checkpointedVotes[account], epoch); votes = ckpt.votes; if (votes == 0 || ckpt.epochStart + lockDuration <= epoch) { return 0; } while (epoch > ckpt.epochStart) { votes -= delegateeUnlocks[account][epoch]; epoch -= rewardsDuration; } }
