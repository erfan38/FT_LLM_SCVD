function offerForETH( uint256 pay_amt, ERC20 pay_gem, uint256 buy_amt, uint256 pos ) external returns (uint256) { ERC20(pay_gem).transferFrom(msg.sender, address(this), pay_amt); uint256 _before = ERC20(wethAddress).balanceOf(address(this)); uint256 id = RubiconMarket(RubiconMarketAddress).offer( pay_amt, pay_gem, buy_amt, ERC20(wethAddress), pos ); uint256 _after = ERC20(wethAddress).balanceOf(address(this)); if (_after > _before) { uint256 delta = _after - _before; WETH9(wethAddress).withdraw(delta); msg.sender.transfer(delta); } return id; }
